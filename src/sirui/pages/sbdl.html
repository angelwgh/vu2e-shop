<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="webkit" name="renderer">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="icon" href="#" type="image/x-icon">
    <title>司睿—商标代理</title>
    <meta name="keywords" content="司睿平台，买商标、卖商标、商标查询、商标代理，近似查询，综合查询，商标名称查询，申请人查询，注册号查询，中文商标，英文商标，拼音商标，数字商标，图形商标，商标导入，商标发布，商标交易，知识产权服务">
    <meta name="description" content="司睿平台是国内专业商标交易平台，提供包括商标查询、商标交易、商标导入管理等一站式服务，是致力于为国内外企业、相关单位及代理机构提供便捷、安全的商标解决方案的综合性网络平台。 商标是品牌的起点，司睿商标网让广大企业的商标品牌建设之路更加平坦，帮助企业商标品牌资源优势最大化，从而提高
        综合竞争力！">
    <meta name="author" content="司睿">
    <link rel="stylesheet" href="../content/css/bootstrap.css">
    <link rel="stylesheet" href="../content/css/public.css">
    <link rel="stylesheet" href="../content/css/common.css">
    <link rel="stylesheet" href="../content/css/lunbo.css">
    <link rel="stylesheet" href="../content/css/style.css">
    <link rel="stylesheet" href="../content/css/nav-table.css">
    <script src="../content/js/lib/hm.js"></script>
    <script src="../content/js/lib/jquery.js"></script>
    <script src="../content/js/lib/bootstrap.js"></script>
    <script src="../content/js/lib/bootstrap-paginator.js"></script>
    <script src="../content/js/lib/doT.js"></script>
    <script src="../content/js/lib/lunbo.js"></script>
    <script src="../content/js/lib/distpicker.js"></script>
</head>

<body style="opacity: 0">
    <!-- 页头开始 -->
    <div class="m-header">
    </div>
    <!-- 页头结束 -->
    <div class="main">
        <!-- 筛选条件 -->
        <div class="nav-table" id="J_nav_table_view">
        </div>

        <div class="clearfix sort_body">
            <ul class="left sort">
                <li class="asc" data-orderby="price">按价格</li>
                <li class="asc" data-orderby="time">按发布时间</li>
            </ul>
            
        </div>
        <div class="agent">
            <ul class="agent_list clearfix" id="J_list_view">
                
            </ul>
        </div>
        <div>
            <ul id="page"></ul>
        </div>
        
    </div>
    <!-- 底部信息开始 -->
    <div class="newfoot">
    </div>
    <!-- 底部信息结束 -->
    <!-- 筛选条件模板 -->
    <script type="text/x-dot-template" id="J_nav_table_temp">
        <div class="nav-item clearfix">
            <div class="title">
                快速筛选
            </div>
            <div class="content">
                <div class="btn btn-info btn-sm" id="J_clear_select">全部清除</div>
            </div>
        </div>
        <div class="nav-item clearfix">
            <div class="title">
                代理名称
            </div>
            <div class="content">
                <input type="text" placeholder="请输入代理名称" id="J_words">
            </div>
        </div>
        <div class="nav-item clearfix">
            <div class="title">
                选择地区
            </div>
            <div class="content">
               <a class="option">
                    <div data-toggle="distpicker" id="distpicker">
                      <select data-province="---- 选择省 ----"></select>
                      <select data-city="---- 选择市 ----"></select>
                    </div>
               </a>
            </div>
        </div>
        <div class="nav-item clearfix" id="preice">
            <div class="title">
                代理费用
            </div>
            <div class="content">
               <a class="option">
                   <input type="text">元 - <input type="text">元
               </a>
            </div>
        </div>
        <div class="nav-item clearfix" id="J_hot_type">
            <div class="title">
                代理类型
            </div>
            <div class="content" data-type="agentType">
                {{ for(var i = 0; i < it.agentType.length; i++){}} <a class="options">
                    {{=it.agentType[i]}}
                    </a>
                    {{} }}
            </div>
        </div>
       
        <div class="nav-item clearfix">
            <div class="title">
                交易保障
            </div>
            <div class="content">
               <a class="option">已缴纳保证金</a>
            </div>
        </div>
        <div class="nav-item clearfix">
            <div class="title">
                
            </div>
            <div class="content">
               <a class="option"><button type="button" class="btn btn-danger" id="J_words_view">查询</button></a>
               <a class="option"><button type="button" class="btn btn-default">重置</button></a>
            </div>
        </div>
    </script>

    <!-- 列表模板 -->
    <script type="text/x-dot-template" id="J_list_temp">

        {{for (var i = 0; i < it.length; i++){ }}
        <li class="protect">
            <div class="img">
                    <img src="{{=it[i].imgsrc}}" alt="企业Logo" >
                </div>
                <div class="infoName clearfix">
                    <span class="tag dark left">{{=it[i].agentType}}</span>
                    <span class="tag_name left" title="{{=it[i].name}}">{{=it[i].name}}</span>
                </div>
                <div class="agent_icon location">{{=it[i].adress}}</div>
                <div class="agent_icon cost">
                    代理费：<span class="font_20 c_red">待议</span>
                </div>
                <div class="agent_icon deal">已成交订单：<span class="font_20 c_red">--</span></div>
                <div class="agent_icon ratio">成交率：<span class="font_20 c_red">--</span></div>
                <div class="button center mt_10">
                    <a class="btn_icon btn_ured" href="sbdl_info.html?AgentId={{=it[i].id}}">进入店铺</a>
                    <a class="btn_icon btn_uorange ml_15" href="">咨询代理</a>

                </div>
             
        </li>
        {{}}}
    </script>
    <script src="../content/js/commom.js"></script>
    <script src="../content/js/util.js"></script>
    <script src="../content/js/template/header.js"></script>
    <script src="../content/js/template/foot.js"></script>
    <script src="../content/js/index.js"></script>
    <script src="../content/js/lib/mock-min.js"></script>
    <script src="../config.js"></script>
    <script>
    var page
    $(function() {
        templates.header.render({
            el: '.m-header',
            search: function (data) {
                // 页头点击搜索按钮调用方法
                console.log(data)
            }
        })

        templates.footer.render({
            el: '.newfoot'
        })



        function Page() {
            this.searchData = {}
            this.pageNo = 1;
            this.pageSize = 24;
            this.totalPage = 1
            this.init()
        }

        Page.prototype = {
            init: function() {

                this.renderNavTable()
                this.distpicker()
                this.getListFromServer()
                this.getTotalPage()
            },

            renderNavTable: function() {
                var data = {
                    agentType:['不限','代理机构','独立代理人'],
                    copyrightType: ['文字作品','美术作品','音乐、舞蹈等艺术作品','建筑作品','摄影作品','影视作品','软件作品','工程作品','其他'],
                    patentsType:['发明专利','实用新型专利','外观设计专利'],
                    // fromby: ['持有人', '平台经纪', '代理'],
                    lawStatus:['转让','授权/许可'],
                    price: ['待议价', '1万以下', '1－5万', '5－10万', '10万以上']
                }
                var temptext = doT.template($('#J_nav_table_temp').html())
                $('#J_nav_table_view').html(temptext(data))

                this.addNavTableEvents()
               
            },

            // 导航表添加点击事件
            addNavTableEvents: function() {
                var self = this;
                var data = self.searchData

                $('#J_cat_type').on('click', '.options', select)
                $('#J_hot_type').on('click', '.options', select)
                $('#J_formby').on('click', '.options', select)
                $('#J_tm_type').on('click', '.options', select)
                $('#J_price').on('click', '.options', select)
                $('#J_words_view').on('click', select)

                function select() {

                    var $this = $(this);
                    var type = $this.parent().data().type;
                    if ($this.hasClass('options')) {
                        if ($this.hasClass('active')) {
                            $this.parent().children().removeClass('active')
                            delete data[type]
                        } else {
                            $this.parent().children().removeClass('active');
                            $this.addClass('active')
                            data[type] = $this.addClass('active').text()

                        }
                    }


                   
                    // self.getListFromServer()
                }
                $('#J_words_view').on('click', function () {
                    data.words = $('#J_words').val()
                    data.adress = self.adress
                    data.price_min = $('#preice').find('input')[0].value;
                    data.price_max = $('#preice').find('input')[1].value;

                    console.log(data)
                    self.getListFromServer()
                })



                $('#J_clear_select').on('click', function() {
                    $('#J_nav_table_view').find('.options').removeClass('active')
                    data = {}
                })

            },
           
            // 获取列表数据
            getListFromServer: function() {
                var self = this;
                var data = this.searchData
                data.pageSize = this.pageSize
                // console.log(data)
                configData.getAgentList({
                    data: data,
                    success: function (data) {

                        var temptext = doT.template($('#J_list_temp').html())
                        $('#J_list_view').html(temptext(data.jsonBody))
                        // console.log(data)   
                        self.getTotalPage(data.totalSize)
                        // this.renderPaginator(data)
                    }
                })
            },

            // 获取总页数
            getTotalPage: function (totalSize) {
                // console.log(totalSize)
                var totalPages = Math.ceil((totalSize || 1) / this.pageSize);
                if(totalPages !== this.totalPages){
                    this.totalPages = totalPages
                    this.renderPaginator()
                }
                
                
            },

            // 分页器
            renderPaginator: function () {
                var self = this
                var currentPage = this.pageNo;
                var totalPages = this.totalPages;
                $("#page").bootstrapPaginator({
                    bootstrapMajorVersion: 3, //对应的bootstrap版本
                    currentPage: currentPage, //当前页数
                    numberOfPages: 10, //每次显示页数
                    totalPages: totalPages, //总页数
                    shouldShowPage: true, //是否显示该按钮
                    useBootstrapTooltip: true,
                    //点击事件
                    onPageClicked: function(event, originalEvent, type, page) {
                        if(page === self.pageNo) return;
                        self.pageNo = page;
                        // console.log(originalEvent)
                        // console.log(event)
                        // console.log(page)
                        // self.searchData.pageSize = page;
                        self.getListFromServer()
                    }
                });
            },
            /**
            *   地址选择器
            */
            distpicker: function () {
                var self = this;
                this.adress = ''
                $('#distpicker').distpicker({
                  province: '---- 所在省 ----',
                  city: '---- 所在市 ----',
                  district: '---- 所在区 ----'
                }).on('change',function (event) {
                    var adress = []
                    $('#distpicker').find('select').each(function (i,el) {
                       adress.push($(el).val())
                    })
                    self.adress = adress.join(' ')

                    console.log(self.adress)
                });

            }
        };

        

        page = new Page()
    })
    </script>
</body>

</html>